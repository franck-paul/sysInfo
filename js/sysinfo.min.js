"use strict";dotclear.ready(()=>{dotclear.mergeDeep(dotclear,dotclear.getData("sysinfo"));const e=(e,t,o,r="")=>{dotclear.jsonServicesGet(e,e=>{o(e.html)},t,e=>{dotclear.debug&&console.log(e),window.alert(r)})},t=(t,o,r)=>{switch(o){case"tpl":e("getCompiledTemplate",{file:t},r,dotclear.msg.tpl_not_found);break;case"sc":e("getStaticCacheFile",{file:t},r,dotclear.msg.sc_not_found)}},o=(e,t,o,r,c="")=>{let n;const s=""===c?"":`${c} - `,l=`<div class="${e}_view"><h1>${s}${t}</h1><textarea id="${e}_source">${JSON.parse(window.atob(o))}</textarea></div>`;jQuery.magnificPopup.open({items:{src:l,type:"inline"},callbacks:{open:()=>{if(!dotclear.colorsyntax)return;const t={mode:r||"text/html",tabMode:"indent",lineWrapping:"true",lineNumbers:"true",matchBrackets:"true",autoCloseBrackets:"true",readOnly:"true"};""!==dotclear.colorsyntax_theme&&(t.theme=dotclear.colorsyntax_theme);const o=document.getElementById(`${e}_source`);n=CodeMirror.fromTextArea(o,t)},close:()=>{null!=n&&n.toTextArea()}}})},r=document.querySelectorAll("a.tpl_compiled");for(const e of r)e.addEventListener("click",e=>{e.preventDefault();const r=e.target.textContent;void 0!==r&&t(r,"tpl",t=>{o("tpl_compiled",r,t,"php",e.target.title)})});if(document.getElementById("scform")){const r=e=>{e.preventDefault();const r=e.target.dataset.file;void 0!==r&&t(r,"sc",t=>{o("sc_compiled",e.target.textContent,t)})},c=document.querySelectorAll("a.sc_dir");for(const t of c)t.addEventListener("click",t=>{t.preventDefault();const o=t.currentTarget.textContent;var c,n;c=o,n=c=>{const n=t.target.parentNode.parentNode;n.after(dotclear.htmlToNode(c)),n.remove();const s=document.querySelectorAll("a.sc_subdir");for(const t of s)t.addEventListener("click",t=>{t.preventDefault();const c=t.currentTarget.textContent;var n,s;n=`${o}/${c}`,s=e=>{for(const e of document.querySelectorAll("a.sc_compiled"))e.removeEventListener("click",r);const o=t.target.parentNode.parentNode;o.after(dotclear.htmlToNode(e)),o.remove(),dotclear.condSubmit("#scform td input[type=checkbox]","#scform #delscaction");for(const e of document.querySelectorAll("a.sc_compiled"))e.addEventListener("click",r)},e("getStaticCacheList",{root:n},s,"")})},e("getStaticCacheDir",{root:c},n,"")})}document.getElementById("checklist")?.addEventListener("change",e=>{e.currentTarget?.form.submit()}),document.getElementById("scform")&&document.getElementById("getscaction")?.addEventListener("click",r=>{const c=e=>{e.preventDefault();const r=e.currentTarget.textContent,c=`${r.slice(0,2)}/${r.slice(2,4)}/${r.slice(4,6)}/${r}`,n=e.currentTarget.dataset.dir;t(`${n}/${c}`,"sc",e=>{o("sc_compiled",r,e)})};r.preventDefault();const n=document.getElementById("sccalc_res"),s=document.getElementById("sccalc_preview");n.textContent="",s.textContent="",s.removeEventListener("click",c);const l=document.getElementById("sccalc_url")?.value;void 0!==l&&""!==l&&((t,o)=>{e("getStaticCacheName",{url:t},o,"")})(l,e=>{const t=`${String.fromCharCode(160)+e.slice(0,2)} / ${e.slice(2,4)} / ${e.slice(4,6)} / `;n.textContent=t,s.textContent=e,s.focus(),s.addEventListener("click",c)})});const c=(e,t,o)=>{if(document.getElementById(e)){for(const o of document.querySelectorAll(`#${e} .checkboxes-helpers`))dotclear.checkboxesHelpers(o,void 0,`#${e} td input[type=checkbox]:not(:disabled)`,`#${e} #${t}`);dotclear.enableShiftClick(`#${e} td input[type=checkbox]`),dotclear.condSubmit(`#${e} td input[type=checkbox]`,`#${e} #${t}`),document.querySelector(`form input[type=submit][name=${t}]`)?.addEventListener("click",e=>dotclear.confirm(o,e))}};c("tplform","deltplaction",dotclear.msg.confirm_del_tpl),c("verform","delveraction",dotclear.msg.confirm_del_ver),c("scform","delscaction",dotclear.msg.confirm_del_sc),c("udform","deludaction",dotclear.msg.confirm_del_ud),document.getElementById("expand-all")?.addEventListener("click",e=>{e.preventDefault();const t=document.querySelectorAll("#content details");if(e.currentTarget.getAttribute("open"))for(const e of t)e.removeAttribute("open");else for(const e of t)e.setAttribute("open","open")});const n=document.getElementById("sys_battery");n&&(navigator.getBattery?navigator.getBattery().then(e=>{const t=100*e.level,[o]=n.getElementsByTagName("strong");o&&(o.innerText=`${t}%`)}):n.style.display="none");const s=document.getElementById("attic");s&&e("getAtticVersions",{},e=>{s.outerHTML=e});const l=(e,t=0,o=-1,r=-1)=>{const c=document.getElementById(e);if(!c)return;c.classList.add("js-sortable");const n=c.querySelectorAll("th");for(const e of n)e.innerText&&e.setAttribute("tabindex","0");const s=c.querySelector("tbody"),l=s.querySelectorAll("tr"),a=Array.from(n).map(()=>{}),d=(e,t)=>{const c=a[t]||"asc",d="asc"===c?1:-1,i=Array.from(l);i.sort((c,n)=>{let s=c.querySelectorAll("td")[e].innerHTML,l=n.querySelectorAll("td")[e].innerHTML;if(o===t)return function(e,t){if(e===t)return 0;const o=e.split("."),r=t.split("."),c=Math.max(o.length,r.length);for(let e=0;e<c;e++){if(Number.parseInt(o[e])>Number.parseInt(r[e])||o[e]===r[e]&&Number.isNaN(r[e+1]))return 1*d;if(Number.parseInt(o[e])<Number.parseInt(r[e])||o[e]===r[e]&&Number.isNaN(o[e+1]))return-1*d}}(s,l);if(r===t)switch(s=Number.parseInt(c.querySelectorAll("td")[e].innerText),l=Number.parseInt(n.querySelectorAll("td")[e].innerText),!0){case s>l:return 1*d;case s<l:return-1*d;case s===l:return 0}return s.localeCompare(l)*d});for(const e of l)s.removeChild(e);for(const e of i)s.appendChild(e);for(const e of n)e.classList.remove("sorted-asc","sorted-desc");n[t].classList.add(`sorted-${c}`),a[t]="asc"===c?"desc":"asc"};if(n.length)for(let e=n.length-1;e>=0;e--)n[e].addEventListener("click",()=>d(e+t,e)),n[e].addEventListener("keypress",e=>{"Enter"===e.key&&(e.target.click(),e.preventDefault())})};for(const e of["antispams","autoloads","constants","dotclear-config","dotclear-release","permissions","restmethods","tplpaths","urls","statuses_blog","statuses_user","statuses_post","statuses_comment","posttypes"])l(e);l("thumbnails",0,-1,1),l("statuses_blog",0,-1,2),l("statuses_user",0,-1,2),l("statuses_post",0,-1,2),l("statuses_comment",0,-1,2),l("exceptions",0,-1,2)});
